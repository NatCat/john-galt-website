---
import { getLocalizedPath, type Locale } from '../lib/translations';

interface Props {
  data?: any;
  locale?: Locale;
}

const { locale = 'en' } = Astro.props;
const defaultAbout = {
  tag: 'About Us',
  heading: 'Partner Group "John Galt"',
  paragraphs: [
    'Our group unites several organizations and teams engaged in the production of technological equipment and industrial automation systems for the food industry, welding and electrical installation services, real-time software development, as well as sourcing and importing technological components.',
    'As a group of companies and technical crews operating across multiple countries, we work with a wide range of clients — from large vertically integrated industrial corporations to individual customers with specific technical needs. Our contactable technical representatives are located in regions including the Balkans, the South Caucasus and Iran, China, India, and CIS countries.',
  ],
  capabilities: [
    'Manufacturing of mixing and filtration equipment for the alcoholic beverage industry (including the continuous blending and treatment technology known as "Ruchey"), as well as the development of comprehensive solutions for vodka and spirits production lines using both traditional and simplified methods;',
    'Production, maintenance, and servicing of proprietary and third-party industrial and municipal water purification systems based on reverse osmosis, microfiltration, and ion exchange technologies — including for food and pharmaceutical enterprises, boiler rooms, and water intake stations;',
    'Supply and maintenance of low-capacity water treatment systems for small and medium-sized businesses (restaurants, hotels, private homes), as well as for residential infrastructure;',
    'Technological installation and commissioning services at enterprises with continuous production cycles (e.g. food, alcohol, chemical, and fuel industries), particularly where stainless-steel tank and piping systems are used;',
    'Custom and small-batch production of low-voltage and power control cabinet equipment — based on schematic documentation, technical specifications, or open client requirements. This includes component supply, cabinet software development (softlogic, microSCADA), and preparation of technical documentation;',
    'Installation of distributed soil, hydrological, and meteorological monitoring stations for agriculture, aquaculture, and municipal applications;',
    'Supply of components and ready-to-use modules for scalable energy storage systems (e.g. redox systems);',
    'Development of bespoke software for automated process control and operational/production management systems (SCADA, MRPI, MRPII).',
  ],
  stats: [
    { icon: 'Users', value: '50+', label: 'Expert Engineers' },
    { icon: 'Award', value: '15+', label: 'Years Experience' },
    { icon: 'Globe', value: '25+', label: 'Countries Served' },
    { icon: 'CheckCircle2', value: '200+', label: 'Completed Projects' },
  ],
};

const iconPaths: Record<string, string> = {
  Users: 'M8 4a4 4 0 118 0 4 4 0 01-8 0zM3 20a7 7 0 0114 0v1H3v-1z',
  Award: 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z',
  Globe: 'M21 12a9 9 0 11-18 0 9 9 0 0118 0z M3.6 9h16.8 M3.6 15h16.8 M9 3.6a15.3 15.3 0 010 16.8 M15 3.6a15.3 15.3 0 010 16.8',
  CheckCircle2: 'M9 12.75l2.25 2.25 4.5-4.5m6 2.25A9 9 0 118 4.5a9 9 0 0118 9z',
};

const incoming = Astro.props.data ?? {};
const about = {
  ...defaultAbout,
  ...incoming,
  paragraphs: incoming.paragraphs && incoming.paragraphs.length > 0 ? incoming.paragraphs : defaultAbout.paragraphs,
  capabilities: incoming.capabilities && incoming.capabilities.length > 0 ? incoming.capabilities : defaultAbout.capabilities,
  stats: (incoming.stats && incoming.stats.length > 0 ? incoming.stats : defaultAbout.stats).map((stat, index) => ({
    ...defaultAbout.stats[index % defaultAbout.stats.length],
    ...stat,
  })),
};
---

<section id="about" class="py-20 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid lg:grid-cols-2 gap-12 items-center">
      <!-- Left Content -->
      <div>
        {about.tag && (
          <div class="inline-block px-4 py-2 bg-[#2d4a7c]/10 text-[#2d4a7c] rounded-full mb-4">
            {about.tag}
          </div>
        )}
        <h2 class="text-gray-900 mb-6 text-3xl md:text-4xl font-serif">
          {about.heading}
        </h2>
        {about.paragraphs.length > 0 && (
          <p class="text-gray-600 mb-6">{about.paragraphs[0]}</p>
        )}

        {about.capabilities && about.capabilities.length > 0 && (
          <div class="mb-6">
            <h3 class="text-xl font-serif text-gray-900 mb-4">We operate in the following areas:</h3>
            <div class="space-y-3">
              {about.capabilities.slice(0, 4).map((capability) => (
                <div class="flex items-start gap-3">
                  <svg class="text-[#2d4a7c] flex-shrink-0 mt-1 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span class="text-gray-700 text-sm">{capability}</span>
                </div>
              ))}
            </div>
          </div>
        )}
        
        <a
          href={getLocalizedPath(locale, 'about')}
          class="text-[#2d4a7c] hover:text-[#1e3a5f] inline-flex items-center gap-2 font-medium transition-colors"
        >
          Read more
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </a>
      </div>

      <!-- Right Stats -->
      <div class="grid grid-cols-2 gap-6">
        {about.stats.map((stat, index) => {
          const path = iconPaths[stat.icon] ?? iconPaths[defaultAbout.stats[index % defaultAbout.stats.length].icon];
          return (
            <div class="text-center p-8 rounded-xl border hover:shadow-lg transition-shadow">
              <div class="bg-[#2d4a7c]/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="text-[#2d4a7c] w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={path}></path>
                </svg>
              </div>
              <div class="text-[#2d4a7c] mb-2 text-2xl font-semibold">{stat.value}</div>
              <div class="text-sm text-gray-600">{stat.label}</div>
            </div>
          );
        })}
      </div>
    </div>
  </div>
</section>

